{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Lab 2: Frequency Domain Identification Techniques\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "clear all\n",
    "close all\n",
    "clc"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Beam Properties\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "wn =\n",
      "\n",
      "   17.2300\n",
      "\n",
      "\n",
      "wnunibeam =\n",
      "\n",
      "   34.9725\n",
      "\n"
     ]
    }
   ],
   "source": [
    "l=21.75*0.0254;% length in meters\n",
    "h=0.5*0.0254;% height in meters\n",
    "w=1*0.0254;% width in meters\n",
    "A=w*h;\n",
    "rho=2700;% density in kg/cubicmeter\n",
    "E=7.31e10;% youngs modulus in Pa\n",
    "I = (1/12)*w*h^3; % moment of inertia (m^4)\n",
    "k = (3*E*I)/l^3; % stiffness (N/m)\n",
    "V = l*w*h;% volume (m^3)\n",
    "m = rho*V;% mass (kg)\n",
    "wn = (sqrt(k/m))/(2*pi) % analytical natural frequency of massless beam with concentrated mass in Hz\n",
    "wnunibeam=((1.875)^(2)*sqrt((E*I)/(m*(l)^3)))/(2*pi) % natural freqency of a uniform section beam in Hz\n",
    "%c_cr = 2*sqrt(k*m); % critical damping coefficient"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Freq versus Magnitude plot\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "collapsed": true,
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "load('Case2-2.mat')\n",
    "H=20*log10(abs(Hf_chan_2));% in dB\n",
    "f=Freq_domain; % in Hz\n",
    "figure\n",
    "plot(f, H)\n",
    "grid on\n",
    "grid minor\n",
    "title('Case 2: Freqency vs Magnitude')\n",
    "xlabel('f(Hz)')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Quadrature peak picking\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "fd =\n",
      "\n",
      "   34.0600\n",
      "\n",
      "\n",
      "zeta =\n",
      "\n",
      "    0.0103\n",
      "\n",
      "\n",
      "fn =\n",
      "\n",
      "   34.0618\n",
      "\n"
     ]
    }
   ],
   "source": [
    "hpeak=85.23;% obtained from plot\n",
    "fd=34.06 %obtained from plot\n",
    "thredb=(hpeak)/sqrt(2);\n",
    "fda=33.65;%obtained from plot\n",
    "fdb=34.35;%obtained from plot\n",
    "zeta=(fdb-fda)/(2*fd)\n",
    "fn=fd/sqrt(1-zeta^2) % in hertz"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Using Vibration Toolbox\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "> In sdofcf (line 107)\n",
      "Warning: Rank deficient, rank = 4, tol =  4.511444e+02.\n",
      "> In sdofcf (line 129)\n",
      "Warning: Rank deficient, rank = 3, tol =  6.808134e-04.\n",
      "zeta = 0.00055664\n",
      "f = 34.0605 Hz.\n",
      "amplitude = 0.\n"
     ]
    }
   ],
   "source": [
    "load('Case2-2')\n",
    "Fmin=30;\n",
    "Fmax=40;\n",
    "sdofcf(Freq_domain,Hf_chan_2,Fmin,Fmax)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "## Closed form solution\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Beta1 =\n",
      "\n",
      "    3.3942\n",
      "\n",
      "\n",
      "Beta2 =\n",
      "\n",
      "    8.4969\n",
      "\n",
      "\n",
      "w1 =\n",
      "\n",
      "  219.7631\n",
      "\n",
      "\n",
      "f1 =\n",
      "\n",
      "   34.9764\n",
      "\n",
      "\n",
      "w2 =\n",
      "\n",
      "   1.3772e+03\n",
      "\n",
      "\n",
      "f2 =\n",
      "\n",
      "  219.1932\n",
      "\n"
     ]
    }
   ],
   "source": [
    "Beta1= 1.87510407/l\n",
    "Beta2= 4.69409133/l\n",
    "\n",
    "w1=Beta1^2*sqrt((E*I)/(rho*A))\n",
    "f1=((Beta1^2)/(2*pi))*sqrt((E*I)/(rho*A))\n",
    "w2=Beta2^2*sqrt((E*I)/(rho*A))\n",
    "f2=((Beta2^2)/(2*pi))*sqrt((E*I)/(rho*A))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Beam Deflection at center due to an excitation on the tip with specified frequency (using vibration toolbox)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "xin=l; %excitation location\n",
    "xout=l/2; % interested Deflection \n",
    "freq=100; % in Hz\n",
    "F=100; % in Newtons\n",
    "fmin=0;\n",
    "fmax=100;% \n",
    "bctype=2;% for cantilever beam\n",
    "beamparams=[E I rho A l];\n",
    "[fout,H]=vtb6_5(xin,xout,fmin,fmax,beamparams,bctype);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "displacement =\n",
      "\n",
      "   2.0861e-07\n",
      "\n"
     ]
    }
   ],
   "source": [
    "find(fout==100);\n",
    "admittance=abs(H(2001));\n",
    "displacement=admittance*F % in meters"
   ]
  }
 ],
 "metadata": {
  "hide_input": false,
  "kernelspec": {
   "display_name": "Matlab",
   "language": "matlab",
   "name": "matlab"
  },
  "language_info": {
   "codemirror_mode": "octave",
   "file_extension": ".m",
   "help_links": [
    {
     "text": "MetaKernel Magics",
     "url": "https://github.com/calysto/metakernel/blob/master/metakernel/magics/README.md"
    }
   ],
   "mimetype": "text/x-matlab",
   "name": "matlab",
   "version": "0.14.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
